{--
----------------------------------------------------------------
-     This module simply defines all the custom types
-     used in the map editor.
----------------------------------------------------------------
--}

module Types (
               TileType(..)
             , Tile(..)
             , Pixels
             , Camera
             , Alist
             , AppResource(..)
             , AppData(..)
             , AppState
             , AppEnv
             , Panel
             ) where

import Control.Monad.Reader
import Control.Monad.State

import Data.Array
import Data.Word (Word16)

import Graphics.UI.SDL (Rect, Surface)

import Pokemap
import Timer

{-
*****************************************************************
*                      Type synonyms
*****************************************************************
-}

-- Used to clarify functions signature when they need the dimensions in tiles
type Pixels = Int

type Camera = Rect

type Alist  = Array Int Rect

type AppState = StateT AppData IO

type AppEnv   = ReaderT AppResource AppState

-- Panel's top left corner coordinates (in tiles, relative to sprite sheet)
type Panel = (Int, Int)

{-
*****************************************************************
*                      End of Type synonyms
*****************************************************************
-}


{-
*****************************************************************
*                      Custom Data Types
*****************************************************************
-}

-- Read-only material
data AppResource = AppResource {
      resScreen      :: Surface -- the screen to blit on
    , resSpriteSheet :: Surface -- the sprites
    } deriving (Show)

-- State of the application
data AppData = AppData {
      appWorld        :: World     -- the map
    , appPanel        :: Panel     -- top left corner of the panel (in tiles)
    , appFps          :: Timer     -- to cap frame rate
    , appCamera       :: Camera    -- our field of vision
    , appCurrentTile  :: TileType  -- the tile we are currently painting with
    , appBye          :: Bool
    } deriving (Show)

-- Tile type : full typed (as opposed to Word16 representation)
data Tile = Tile {
      tBox       :: Rect
    , tTileType  :: TileType
    } deriving (Show)

-- Tile types
data TileType =
      NullTile           -- For mapping purpose : not accessible
    | Grass              -- Most common tile type
    | Rough              -- Where PoKemons pop
      deriving (Show, Eq, Enum)

{-
*****************************************************************
*                      End of Custom Data Type
*****************************************************************
-}